<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Snake | Малориса</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Yandex Games SDK -->
<script src="https://sdk.games.s3.yandex.net/sdk.js"></script>

<link href="https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap" rel="stylesheet">

<style>
body{
  margin:0;
  background:#0e0e11;
  font-family:'Press Start 2P', monospace;
  color:#fff;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
}

#gameWrap{
  width:360px;
  text-align:center;
}

canvas{
  background:#14141a;
  border-radius:16px;
  display:none;
}

button{
  font-family:'Press Start 2P';
  font-size:11px;
  padding:14px;
  width:100%;
  border:none;
  border-radius:14px;
  background:#ff7aa2;
  color:#000;
  cursor:pointer;
  margin-top:12px;
}

button:active{transform:scale(.96)}

#startScreen{
  background:#14141a;
  padding:20px;
  border-radius:18px;
}

.skin-btn{
  background:#222;
  padding:10px;
  margin-top:8px;
  border-radius:12px;
  cursor:pointer;
  transition:.25s;
}

.skin-btn.active{
  background:#ff7aa2;
  color:#000;
  transform:scale(1.1);
  box-shadow:0 0 16px #ff7aa2;
}

#score{
  margin:12px 0;
}

#records{
  font-size:10px;
  margin-top:16px;
  text-align:left;
}
</style>
</head>

<body>
<div id="gameWrap">

<div id="startScreen">
  <h3>ЗМЕЙКА</h3>

  <div class="skin-btn active" data-skin="malorisa">МАЛОРИСА</div>
  <div class="skin-btn" data-skin="classic">КЛАССИКА</div>
  <div class="skin-btn" data-skin="neon">НЕОН</div>

  <button onclick="startGame()">НАЧАТЬ ИГРУ</button>

  <div id="records">
    <b>Рекорды:</b><br>
    1. Глеб — 42<br>
    2. Аня — 35<br>
    3. Макс — 28
  </div>
</div>

<div id="score">Очки: 0</div>
<canvas id="game" width="360" height="360"></canvas>

</div>

<script>
const canvas = document.getElementById("game")
const ctx = canvas.getContext("2d")
const box = 24
let game

const skins = {
  malorisa:{ color:"#ff7aa2" },
  classic:{ color:"#7CFF7C" },
  neon:{ color:"#00ffe7" }
}

let currentSkin = "malorisa"

const headStyles = {
  cute:[
    [0,1,1,1,0],
    [1,0,1,0,1],
    [1,1,1,1,1],
    [1,0,1,0,1],
    [0,1,1,1,0],
  ]
}

let snake, food, dir, score

document.querySelectorAll(".skin-btn").forEach(btn=>{
  btn.onclick=()=>{
    document.querySelectorAll(".skin-btn").forEach(b=>b.classList.remove("active"))
    btn.classList.add("active")
    currentSkin = btn.dataset.skin
  }
})

document.addEventListener("keydown",e=>{
  if(e.key==="ArrowUp"&&dir!=="DOWN")dir="UP"
  if(e.key==="ArrowDown"&&dir!=="UP")dir="DOWN"
  if(e.key==="ArrowLeft"&&dir!=="RIGHT")dir="LEFT"
  if(e.key==="ArrowRight"&&dir!=="LEFT")dir="RIGHT"
})

function startGame(){
  document.getElementById("startScreen").style.display="none"
  canvas.style.display="block"
  document.getElementById("score").style.display="block"

  snake=[{x:7,y:7}]
  dir="RIGHT"
  score=0
  spawnFood()

  clearInterval(game)
  game=setInterval(draw,130)
}

function spawnFood(){
  food={
    x:Math.floor(Math.random()*14),
    y:Math.floor(Math.random()*14)
  }
}

function drawHead(x,y,color){
  const p=headStyles.cute
  const px=box/5
  p.forEach((r,ry)=>{
    r.forEach((c,cx)=>{
      if(c){
        ctx.fillStyle=color
        ctx.fillRect(x*box+cx*px,y*box+ry*px,px,px)
      }
    })
  })
}

function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height)

  const head=snake[0]
  let nx=head.x
  let ny=head.y

  if(dir==="UP")ny--
  if(dir==="DOWN")ny++
  if(dir==="LEFT")nx--
  if(dir==="RIGHT")nx++

  if(nx<0||ny<0||nx>=15||ny>=15||snake.some(s=>s.x===nx&&s.y===ny)){
    clearInterval(game)
    alert("Игра окончена! Очки: "+score)
    location.reload()
  }

  if(nx===food.x&&ny===food.y){
    score++
    document.getElementById("score").innerText="Очки: "+score
    spawnFood()
  }else{
    snake.pop()
  }

  snake.unshift({x:nx,y:ny})

  drawHead(snake[0].x,snake[0].y,skins[currentSkin].color)

  ctx.fillStyle=skins[currentSkin].color
  snake.slice(1).forEach(s=>{
    ctx.fillRect(s.x*box+3,s.y*box+3,box-6,box-6)
  })

  ctx.fillStyle="#ffd700"
  ctx.fillRect(food.x*box+6,food.y*box+6,box-12,box-12)
}
</script>
</body>
</html>
